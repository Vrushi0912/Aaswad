<header class="primary-header container">
  <button id="back-button" class="back-button"></button>
  <a href="/"><img src="/img/lastlogo.svg" class="logo" alt="Aaswad Logo" /></a>
  <nav class="primary-navigation">
    <ul role="list" class="nav-list">
      <li><a href="/">Home</a></li>
      <li><a href="#about">About</a></li>
      <li><a href="/menu">Popular</a></li>
      <li><a href="/menu">Menu</a></li>
      <li><a href="#testimonials">Reviews</a></li>
      <li><a href="#contact-us">Contact Us</a></li> <!-- New link to Contact Us -->

    </ul>
  </nav>

  <div class="icons">
    <a href="/menu/search" class="icon-hover"><i class="fa-solid fa-magnifying-glass icon"></i></a>
    <div class="profile">
      <div id="profileBtn" class="icon-hover"
        ><i class="fa-solid fa-user icon"></i
      ></div>
      <div class="profile__menu">
        <ul role="list" class="menu__list">
          <li><a href="#"><%= user.name %></a></li>
          <li><a href="/orders">Orders</a></li>
          <li><a href="/user/logout">Logout</a></li>
        </ul>
      </div>
    </div>
    <a href="/cart" class="cart icon-hover"
      ><i class="fa-solid fa-cart-shopping icon"></i>
      <% if(cart) {%>
        <span class="cart__count" id="cartCount"> <%= cart.items.length %> </span>
      <% }else{ %>
        <span class="cart__count" id="cartCount">0</span>
        <% } %>
    </a>
  </div>
</header>
<main>
  <!-- If Cart is Empty -->
  <% if( (!cart) || (!cart.items.length>0) ){ %>
    <section class="alt__section container">
      <div class="alt">
      <h2 class="section__title">Your Cart is Empty !!</h2>
      <a href="/menu" class="btn empty__cta">See Menu</a>
      <a href="/orders" class="btn empty__cta orders__btn">Orders</a>
      <div class="cta-buttons">
        <a href="/menu" class="cta-btn menu-btn">Browse Menu</a>
        <a href="/orders" class="cta-btn orders-btn">View Orders</a>
      </div>
      </div>
      <section class="estimated-delivery">
        <h3 class="delivery-title">Estimated Delivery Time</h3>
        <div class="delivery-container">
          <!-- Delivery Time Box -->
          <div class="delivery-item">
            <div class="delivery-icon">
              <i class="fa-solid fa-clock"></i>
            </div>
            <div class="delivery-info">
              <p>Your order will arrive in:</p>
              <p class="delivery-estimate">45 - 60 minutes</p>
            </div>
          </div>
      
          <!-- Progress Bar -->
          <div class="delivery-item progress-container">
            <div class="progress-bar">
              <div class="progress"></div>
              <span class="progress-text">50%</span> <!-- Shows progress percentage -->
            </div>
          </div>
      
          <!-- Delivery Info (Truck Icon) -->
          <div class="delivery-item">
            <div class="delivery-icon">
              <i class="fa-solid fa-truck"></i>
            </div>
            <div class="delivery-info">
              <p class="delivery-note">Your food is on its way! Hang tight!</p>
            </div>
          </div>
        </div>
      </section>

      <section class="special-offers">
        <h3 class="offers-title">Special Offers</h3>
        <div class="offers-container">
          <!-- Offer Item 1 -->
          <div class="offer-item">
            <div class="offer-icon">
              <i class="fa-solid fa-percent"></i>
            </div>
            <div class="offer-details">
              <h4>10% OFF Your First Order!</h4>
              <p>Sign up and get a 10% discount on your first order. Don't miss out!</p>
            </div>
          </div>
          <!-- Offer Item 2 -->
          <div class="offer-item">
            <div class="offer-icon">
              <i class="fa-solid fa-truck"></i>
            </div>
            <div class="offer-details">
              <h4>Free Delivery on Orders Over $30</h4>
              <p>Enjoy free delivery when you spend $30 or more. Order now!</p>
            </div>
          </div>
          <!-- Offer Item 3 -->
          <div class="offer-item">
            <div class="offer-icon">
              <i class="fa-solid fa-gift"></i>
            </div>
            <div class="offer-details">
              <h4>Buy 1 Get 1 Free on Selected Items</h4>
              <p>Choose from our special menu and get another item for free. Limited time only!</p>
            </div>
          </div>
        </div>
      </section>
   
      
    </section>
    <footer class="site-footer">
      <div class="footer-container">
        <!-- Footer Left: About and Contact -->
        <div class="footer-left">
          <h3 class="footer-logo">Aaswad</h3>
          <p class="footer-description">Bringing you delicious meals straight to your door. Fast, fresh, and always satisfying.</p>
          
      <!-- Footer Contact Section -->
<div class="footer-contact">
  <p><strong>Contact Us:</strong></p>
  <ul class="contact-list">
    <li>Email: info@aaswad.com</li>
    <li>Phone: +1 234 567 890</li>
  </ul>
</div>

        </div>
        
        <!-- Footer Center: Useful Links -->
        <div class="footer-links">
          <h4 class="footer-title">Quick Links</h4>
          <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">Menu</a></li>
            <li><a href="#">Privacy Policy</a></li>
            <li><a href="#">Contact Us</a></li>
          </ul>
        </div>
        
        <!-- Footer Right: Social Media -->
        <div class="footer-social">
          <h4 class="footer-title">Follow Us</h4>
          <div class="social-icons">
            <a href="https://www.facebook.com/profile.php?id=100095689054459" class="social-icon"><i class="fab fa-facebook"></i></a>
            <a href="https://twitter.com/VrushketM31712?t=wsWoGu-nmFc1JuRYQNN-7g&s=09" class="social-icon"><i class="fab fa-twitter"></i></a>
            <a href="https://www.facebook.com/profile.php?id=100095689054459" class="social-icon"><i class="fab fa-instagram"></i></a>
            <a href="https://youtube.com/@ofa-08vrushketvivekmulye61?si=jOp2gDyPEDc3FVCt" class="social-icon"><i class="fab fa-youtube"></i></a>
            <a href="https://www.linkedin.com/in/vrushket-mulye-a5468a287/" class="social-icon"><i class="fab fa-linkedin"></i></a>
          </div>
        </div>
        
      </div>
        <!-- Business Hours Section -->


      
      <div class="footer-bottom">
        <div class="newsletter">
          <h4>Stay Updated</h4>
          <input type="email" id="newsletterEmail" placeholder="Enter your email" class="newsletter-input">
          <button type="button" id="subscribeBtn" class="newsletter-btn">Subscribe</button>
        </div>
      </div>


      <!-- Success Message Popup -->
      <div id="successMessage" class="popup-message">
        <div class="message-content">
          <i class="fa-solid fa-check-circle message-icon"></i>
          <p class="message-text">Thank you for subscribing!</p>
          <button id="closeMessage" class="close-btn">Close</button>
        </div>
      </div>
    </footer>
    
    <!-- If Cart is Not Empty -->
  <% } else{ %>
    <section class="cart__section container">
      <div class="cart__flex">
        <h2 class="section__title">Cart</h2>
        <!-- Declaring Variables for sending Order Post Request using Place Order Button -->
        <% var itemName=[] %>
        <% var itemServe=[] %>
        <% var itemQty=[] %>
        <% var itemPrice=[] %>
        <% var subTotal=0 %>
        <% var grandTotal=0 %>
        <!-- Using forEach it'll iterate every item in cart with variable 'cartList' -->
        <% cart.items.forEach((cartList)=>{ %> 
          <!-- Here it'll find index of items that are in cart list using their itemId and further can be used to Show Food items Details from items database -->
          <% const index = items.findIndex((item) => { %>
            <% return item.itemId == cartList.itemId; }); %>

          <div class="cart__item">
            <div class="item__details">
              <!-- To Send itemId to client side Javascript for Api Request-->
              <input type="hidden" id="itemId" value="<%= cartList.itemId %>"> 

              <p class="item__name"> <%= items[index].name %> <span class="remove__item">(remove)</span></p>
              <p class="item__unit"> <%= items[index].serve*cartList.qty %> <%= items[index].unit %> </p>
            </div>
            <div class="price__details">
              <div class="qty__control">
                <!-- To Send itemId to client side Javascript for Api Request-->
                <input type="hidden" id="itemId" value="<%= cartList.itemId %>"> 
                
                <input type="hidden" id="qty" value="<%= cartList.qty %>"> 
                <button class="qty__btn dec" >-</button>
                <span class="item__qty"><%= cartList.qty %></span>
                <button class="qty__btn inc" >+</button>
              </div>
              <p class="item__price">&#8377;<%= items[index].price * cartList.qty%></p>
            </div>
          </div>
          <!-- Updating Variables value for sending Order Post Request using Place Order Button -->
          <% itemName.push(items[index].name) %>
          <% itemServe.push(`${items[index].serve} ${items[index].unit}`) %>
          <% itemQty.push(cartList.qty) %>
          <% itemPrice.push(items[index].price) %>
          <% subTotal+=(items[index].price * cartList.qty) %>
          <!-- End of Updating Value -->

        <% }) %>
      </div>
    </section>


    
    <section class="bill__section container">
      <div class="bill__flex">
        <!-- <h3 class="bill__title bill">Bill Summary</h3> -->
        <div class="subtotal bill">
          <p class="subtotal__title">Subtotal</p>
          <p class="item__total">&#8377;<%= subTotal %></p>
          <!-- Updating grandTotal = subTotal -->
          <% grandTotal=subTotal %>

        </div>
        <div class=" bill">
          <!-- Declaring tax variable -->
          <% const tax=+(grandTotal*(0.04)).toFixed(2) %>
          <% grandTotal+= tax %>

          <p class="tax__title">Tax</p>
          <p class="tax__total">&#8377;<%= tax %></p>
        </div>
        <div class="delivery bill">
          <!-- Declaring Delivery Charge variable -->
          <% const deliveryCharge=30 %>
          <% grandTotal+= deliveryCharge %>

          <p class="delivery__title">Delivery Charge</p>
          <p class="delivery__charge">&#8377;<%= deliveryCharge %></p>
        </div>
        <div class="grandtotal bill">
          <p class="grandtotal__title">Grandtotal</p>

          <!-- Fixing GrandTotal to only two decimal point -->
          <% grandTotal=grandTotal.toFixed(2) %>
          <p class="grand__total">&#8377;<%= grandTotal %></p>
        </div>
      </div>
    </section>  
    <section class="address__section container">
      <div class="address__flex">
        <h3 class="address__title addr">Delivery Address</h3>
        <div class="address addr" id="addressContainer">
          <% if((user.address!=null) && (user.address.trim().length!=0)) {%>
            <p class="user__address"> <i class="fa-solid fa-location-dot"></i> <%= user.address %> <span class="edit__btn" id="editBtn"><i class="fa-solid fa-pen-to-square"></i> </span> </p>
          <% } else{%>
            <input type="text" id="newAddress" name="address" class="address__input" placeholder="Enter your address" spellcheck="false">
            <button class="update__btn" id="updateBtn">Update</button>
            <% } %>

          </div>
          <% if((user.address!=null) && (user.address.trim().length!=0)) {%>
            <div id="proceedContainer" class="proceed">
              <!-- Some Hidded Input Fields to send Api request to Order Post  -->
              <input type="hidden" id="itemName" name="itemName" value=" <%= itemName %> ">
              <input type="hidden" id="itemServe" name="itemServe" value=" <%= itemServe %> ">
              <input type="hidden" id="itemQty" name="itemQty" value=" <%= itemQty %> ">
              <input type="hidden" id="itemPrice" name="itemPrice" value=" <%= itemPrice %> ">
              <input type="hidden" id="subTotal" name="subtotal" value=" <%= subTotal%> ">
              <input type="hidden" id="tax" name="tax" value=" <%= tax %> ">
              <input type="hidden" id="deliveryCharge" name="deliveryCharge" value=" <%= deliveryCharge %> ">
              <input type="hidden" id="grandTotal" name="grandTotal" value=" <%= grandTotal %> ">
              <!-- End -->

              <input type="submit" id="placeOrderBtn" class="proceed__btn active" value="Place Order&#9205;">
            </div>
          <% } else{%>
            <div id="proceedContainer" class="proceed">
              <input type="button" class="proceed__btn" title="Please update your address before placing order." value="Place Order&#9205;">
            </div>
            <% } %>
      </div>
    </section>

    

    <% } %>

    <div class="popup" id="popup">
      <h1 class="popup__message">Order Placed</h1>
    </div>

    <div class="overlay" id="overlay"></div>
   
<div class="top-up-container" style="position: fixed; bottom: 20px; right: 20px;">
  <a href="#" class="top-up-btn" style="display: flex; align-items: center; justify-content: center; background-color: #ff6600; color: white; padding: 10px 20px; border-radius: 50px; font-size: 18px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); text-decoration: none;">
    <i class="fa-solid fa-arrow-up" style="margin-right: 8px;"></i>
  </a>
</div>

</main>


<!-- Scrips -->

<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('subscribeBtn').addEventListener('click', function() {
      var email = document.getElementById('newsletterEmail').value;

      if (email && validateEmail(email)) {
        document.getElementById('successMessage').classList.add('show');
        document.getElementById('newsletterEmail').value = '';
      } else {
        alert('Please enter a valid email address.');
      }
    });

    function validateEmail(email) {
      var re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    document.getElementById('closeMessage').addEventListener('click', function() {
      document.getElementById('successMessage').classList.remove('show');
    });
  });
</script>

<script src="/js/cart.js"></script>
